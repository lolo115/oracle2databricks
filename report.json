{
  "timestamp": "2025-12-22T19:18:42.963516",
  "summary": {
    "total_statements": 1143,
    "successful": 1033,
    "failed": 81,
    "partial": 29,
    "conversion_rate": "90.4%",
    "success_with_warnings_rate": "92.9%"
  },
  "functions": {
    "detected": {},
    "converted": {},
    "unsupported": {},
    "no_equivalent": {},
    "unknown_custom": {}
  },
  "packages_no_equivalent": {},
  "unknown_functions": {},
  "no_equivalent_details": [],
  "unsupported_features": {
    "SAVEPOINT not supported in Databricks - restructure transaction logic": 2,
    "GOTO: GOTO not supported in Databricks - restructure code": 1,
    "AUTONOMOUS_TRANSACTION not supported - use separate procedure call": 1
  },
  "failed_items": [
    {
      "original_sql": "File: examples/input/21_plsql_exceptions.sql (MIXED)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 2, Col: 1.\n  /\n\u001b[4m/\u001b[0m"
      ],
      "warnings": [
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "Exception TOO_MANY_ROWS converted to SQLSTATE '21000'",
        "Exception DUP_VAL_ON_INDEX converted to SQLSTATE '23505'",
        "Exception VALUE_ERROR converted to SQLSTATE '22000'",
        "Exception ZERO_DIVIDE converted to SQLSTATE '22012'",
        "Exception INVALID_NUMBER converted to SQLSTATE '22018'",
        "Exception INVALID_CURSOR converted to SQLSTATE '24000'",
        "Exception CURSOR_ALREADY_OPEN converted to SQLSTATE '24000'",
        "Control flow RAISE_NAMED converted: Use SIGNAL to raise named exception",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "ROLLBACK: Limited transaction support in Databricks SQL.",
        "REF CURSOR: Review cursor handling in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "RAISE_APPLICATION_ERROR converted to SIGNAL SQLSTATE",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "RAISE_APPLICATION_ERROR converted to SIGNAL SQLSTATE",
        "SQLERRM converted to ERROR_MESSAGE()",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "Sequences need conversion to Identity columns or UUID()",
        "DBMS_UTILITY.FORMAT_ERROR_BACKTRACE converted: Stack trace not available",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "SQLERRM converted to ERROR_MESSAGE()",
        "SQLCODE converted to ERROR_CODE()",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions"
      ]
    },
    {
      "original_sql": "File: examples/input/13_etl_scripts.sql (SQL)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Expecting (. Line 1, Col: 46.\n  ALTER TABLE fact_sales DROP PARTITION \u001b[4mp_202301\u001b[0m",
        "Parse error: Invalid expression / Unexpected token. Line 10, Col: 10.\n  r_id,\n    TO_DATE(order_date_str, 'YYYY-MM-DD'),\n    TO_NUMBER(amount_str)\nFROM stg_orders_text\nLOG \u001b[4mERRORS\u001b[0m INTO err$_target_orders ('ETL_' || TO_CHAR(SYSDATE, 'YYYYMMDD'))\nREJECT LIMIT UNLIMITED"
      ],
      "warnings": [
        "Date arithmetic detected - verify date operations",
        "Oracle sequences detected. Consider using Databricks IDENTITY columns or custom sequence implementation.",
        "Date arithmetic detected - verify date operations",
        "Oracle sequences detected. Consider using Databricks IDENTITY columns or custom sequence implementation.",
        "Date arithmetic detected - verify date operations",
        "Oracle sequences detected. Consider using Databricks IDENTITY columns or custom sequence implementation.",
        "Date arithmetic detected - verify date operations",
        "Oracle sequences detected. Consider using Databricks IDENTITY columns or custom sequence implementation.",
        "Oracle sequences detected. Consider using Databricks IDENTITY columns or custom sequence implementation.",
        "Oracle sequences detected. Consider using Databricks IDENTITY columns or custom sequence implementation.",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Oracle sequences detected. Consider using Databricks IDENTITY columns or custom sequence implementation."
      ]
    },
    {
      "original_sql": "File: examples/input/15_plsql_cursors.sql (MIXED)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 1, Col: 1.\n  \u001b[4m/\u001b[0m"
      ],
      "warnings": [
        "Explicit cursors may need manual conversion to Databricks SQL",
        "Cursor FOR loop detected - may need conversion to set-based operations",
        "FETCH INTO detected - consider set-based alternatives",
        "EXIT WHEN clause - control flow may need adjustment",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "SQLCODE converted to ERROR_CODE()",
        "Control flow EXIT_WHEN converted: Convert EXIT WHEN to IF/LEAVE",
        "Collection.COUNT converted: Use SIZE() for collection count",
        "BULK COLLECT converted - result is now array type",
        "FETCH INTO cursor operations may need review for Databricks compatibility",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "TABLE OF types converted to comments - use ARRAY<type>",
        "Found 1 cursor(s): C_EMPLOYEES",
        "Explicit cursor detected - review cursor handling",
        "Cursor attributes (%NOTFOUND, %FOUND, %ROWCOUNT) need manual review",
        "Cursor attribute %FOUND: Track cursor found status in variable",
        "Cursor attribute %NOTFOUND: Track cursor notfound status in variable",
        "Cursor attribute %ROWCOUNT: Track cursor rowcount in variable",
        "Cursor attribute %ISOPEN: Track cursor open status in variable",
        "%TYPE references need actual type lookup",
        "%ROWTYPE references need struct definition from table schema",
        "REF CURSOR: Review cursor handling in Databricks",
        "RECORD types need conversion to STRUCT<>"
      ]
    },
    {
      "original_sql": "File: examples/input/17_plsql_procedures.sql (MIXED)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 2, Col: 1.\n  /\n\u001b[4m/\u001b[0m"
      ],
      "warnings": [
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "OUT parameters detected: ['p_name', 'p_salary', 'p_hire_date']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Convert OUT parameters to alternative approach",
        "OUT parameters detected: ['p_emp_count', 'p_total_sal', 'p_avg_sal', 'p_min_sal', 'p_max_sal']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Convert OUT parameters to alternative approach",
        "OUT parameters detected: ['p_raise_pct']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "Convert OUT parameters to alternative approach",
        "OUT parameters detected: ['p_street', 'p_city', 'p_state', 'p_zip']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "Convert OUT parameters to alternative approach",
        "OUT parameters detected: ['p_emp_id']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "Convert OUT parameters to alternative approach",
        "Sequences need conversion to Identity columns or UUID()",
        "OUT parameters detected: ['p_data']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "Collection.COUNT converted: Use SIZE() for collection count",
        "Convert OUT parameters to alternative approach",
        "OUT parameters detected: ['p_dept_id']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "Convert OUT parameters to alternative approach",
        "Sequences need conversion to Identity columns or UUID()",
        "OUT parameters detected: ['p_updated']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "Convert OUT parameters to alternative approach",
        "Cursor attribute %FOUND: Track cursor found status in variable",
        "OUT parameters detected: ['p_rows_deleted']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "Convert OUT parameters to alternative approach",
        "Cursor attribute %ROWCOUNT: Track cursor rowcount in variable",
        "OUT parameters detected: ['p_result']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "Convert OUT parameters to alternative approach",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "SQLERRM converted to ERROR_MESSAGE()",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "ROLLBACK: Limited transaction support in Databricks SQL.",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "SQLERRM converted to ERROR_MESSAGE()",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "ROLLBACK: Limited transaction support in Databricks SQL.",
        "SAVEPOINT not supported in Databricks - restructure transaction logic",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "Sequences need conversion to Identity columns or UUID()",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "Sequences need conversion to Identity columns or UUID()",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "OUT parameters detected: ['p_success', 'p_message']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "DBMS_UTILITY.FORMAT_ERROR_BACKTRACE converted: Stack trace not available",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "SQLERRM converted to ERROR_MESSAGE()",
        "SQLCODE converted to ERROR_CODE()",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "Control flow RAISE_NAMED converted: Use SIGNAL to raise named exception",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "ROLLBACK: Limited transaction support in Databricks SQL.",
        "Convert OUT parameters to alternative approach",
        "OUT parameters detected: ['p_emp_id']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "SQLERRM converted to ERROR_MESSAGE()",
        "SQLCODE converted to ERROR_CODE()",
        "Convert OUT parameters to alternative approach",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks"
      ]
    },
    {
      "original_sql": "File: examples/input/01_simple_queries.sql (SQL)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 2, Col: 6.\n  */\n\u001b[4mSELECT\u001b[0m employee_id, \n       first_name,  \n       last_name    \nFROM employees"
      ],
      "warnings": [
        "ROWNUM detected - semantics may differ from ROW_NUMBER()",
        "ROWNUM may not work as expected in Databricks"
      ]
    },
    {
      "original_sql": "File: examples/input/22_regex_functions.sql (MIXED)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Invalid expression / Unexpected token. Line 2, Col: 20.\n  DECLARE\n    v_email \u001b[4mVARCHAR2\u001b[0m(100) := 'john.doe@example.com';",
        "Parse error: Invalid expression / Unexpected token. Line 1, Col: 17.\n  v_phone VARCHAR2\u001b[4m(\u001b[0m20) := '(555) 123-4567'",
        "Parse error: Invalid expression / Unexpected token. Line 1, Col: 16.\n  v_text VARCHAR2\u001b[4m(\u001b[0m1000) := 'Order #12345 shipped to John Doe on 2024-06-15'",
        "Parse error: Invalid expression / Unexpected token. Line 1, Col: 33.\n  c_email_pattern CONSTANT \u001b[4mVARCHAR2\u001b[0m(200) := '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$'",
        "Parse error: Invalid expression / Unexpected token. Line 1, Col: 33.\n  c_phone_pattern CONSTANT \u001b[4mVARCHAR2\u001b[0m(100) := '^\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}$'",
        "Parse error: Invalid expression / Unexpected token. Line 2, Col: 19.\n  BEGIN\n    IF REGEXP_LIKE\u001b[4m(\u001b[0mv_email, c_email_pattern) THEN\n        DBMS_OUTPUT.PUT_LINE('Valid email: ' || v_email)",
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 1, Col: 1.\n  \u001b[4m/\u001b[0m"
      ],
      "warnings": [
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "Control flow NULL_STMT converted: NULL statement as no-op"
      ]
    },
    {
      "original_sql": "File: examples/input/23_json_xml_functions.sql (MIXED)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Expecting ). Line 3, Col: 51.\n  JSON_OBJECT(\n    'employee_id' VALUE employee_id,\n    'commission' VALUE commission_pct NULL ON NULL\u001b[4m,\u001b[0m\n    'manager' VALUE manager_id ABSENT ON NULL\n) AS emp_json\nFROM employees\nWHERE ROWNUM <= 3",
        "Parse error: Expecting ). Line 2, Col: 10.\n  SELECT JSON_ARRAY(\n    \u001b[4mSELECT\u001b[0m first_name FROM employees WHERE department_id = 60\n) AS names_array\nFROM DUAL",
        "Parse error: Expecting ). Line 1, Col: 63.\n  SELECT JSON_VALUE('{\"name\":\"John\",\"age\":30}', '$.age' \u001b[4mRETURNING\u001b[0m NUMBER) AS age FROM DUAL",
        "Parse error: Expecting ). Line 1, Col: 52.\n  SELECT JSON_VALUE('{\"name\":\"John\"}', '$.age' \u001b[4mDEFAULT\u001b[0m 0 ON EMPTY) AS age FROM DUAL",
        "Parse error: Expecting ). Line 1, Col: 49.\n  SELECT JSON_VALUE('{\"name\":\"John\"}', '$.age' \u001b[4mNULL\u001b[0m ON ERROR) AS age FROM DUAL",
        "Parse error: Expecting ). Line 1, Col: 56.\n  SELECT JSON_QUERY('{\"items\":[1,2,3]}', '$.items[0]' \u001b[4mWITH\u001b[0m WRAPPER) AS first_item FROM DUAL",
        "Parse error: Expected END after CASE. Line 2, Col: 41.\n  SELECT json_text,\n       CASE WHEN json_text IS JSON \u001b[4mSTRICT\u001b[0m THEN 'Strict JSON' ELSE 'Not strict' END AS strict_check\nFROM (\n    SELECT '{\"name\":\"John\"}' AS jso",
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 2, Col: 6.\n  */\n\u001b[4mSELECT\u001b[0m JSON_DATAGUIDE('{\"name\":\"John\",\"age\":30,\"address\":{\"city\":\"NYC\"}}') AS data_guide\nFROM DUAL",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 1, Col: 28.\n  SELECT XMLELEMENT(\u001b[4m\"employee\"\u001b[0m,\n    XMLELEMENT(\"name\", first_name || ' ' || last_name),\n    XMLELEMENT(\"salary\", salary)\n) AS emp_",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 1, Col: 28.\n  SELECT XMLELEMENT(\u001b[4m\"employee\"\u001b[0m,\n    XMLATTRIBUTES(employee_id AS \"id\", department_id AS \"dept\"),\n    XMLELEMENT(\"name\", first_name",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 1, Col: 28.\n  SELECT XMLELEMENT(\u001b[4m\"employee\"\u001b[0m,\n    XMLFOREST(\n        employee_id AS \"id\",\n        first_name AS \"firstName\",\n        last_name A",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 1, Col: 30.\n  SELECT XMLELEMENT(\u001b[4m\"department\"\u001b[0m,\n    XMLATTRIBUTES(department_id AS \"id\"),\n    XMLAGG(\n        XMLELEMENT(\"employee\",\n            X",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 2, Col: 26.\n  SELECT XMLROOT(\n    XMLELEMENT(\u001b[4m\"employees\"\u001b[0m,\n        XMLAGG(XMLELEMENT(\"emp\", first_name))\n    ),\n    VERSION '1.0'\n) AS xml_doc\nFROM employees",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 2, Col: 22.\n  SELECT XMLCONCAT(\n    XMLELEMENT(\u001b[4m\"first\"\u001b[0m, first_name),\n    XMLELEMENT(\"last\", last_name)\n) AS name_xml\nFROM employees\nWHERE ROWNUM <= 3",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 1, Col: 24.\n  SELECT XMLELEMENT(\u001b[4m\"root\"\u001b[0m,\n    XMLCOMMENT('This is a comment'),\n    XMLPI(NAME \"processor\", 'instruction'),\n    XMLELEMENT(\"d",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 1, Col: 26.\n  SELECT XMLELEMENT(\u001b[4m\"script\"\u001b[0m,\n    XMLCDATA('if (a < b) { return true; }')\n) AS cdata_xml\nFROM DUAL",
        "Parse error: Expecting ). Line 3, Col: 11.\n  SELECT XMLQUERY(\n    '/employee/name/text()'\n    \u001b[4mPASSING\u001b[0m XMLTYPE('<employee><name>John</name><salary>5000</salary></employee>')\n    RETURNING CONTENT\n) AS n",
        "Parse error: Expecting ). Line 5, Col: 11.\n  UERY(\n    'for $emp in /employees/employee\n     where $emp/salary > 5000\n     return $emp/name'\n    \u001b[4mPASSING\u001b[0m XMLTYPE('<employees>\n        <employee><name>John</name><salary>6000</salary></employee>\n        <e",
        "Parse error: Expecting ). Line 4, Col: 40.\n  ('<employee><name>John</name></employee>') AS xml_data FROM DUAL\n)\nWHERE XMLEXISTS('/employee/name' \u001b[4mPASSING\u001b[0m xml_data)",
        "Parse error: Invalid expression / Unexpected token. Line 2, Col: 17.\n  DECLARE\n    v_xml \u001b[4mXMLTYPE\u001b[0m;",
        "Parse error: Invalid expression / Unexpected token. Line 1, Col: 18.\n  v_string VARCHAR2\u001b[4m(\u001b[0m4000)",
        "Parse error: Invalid expression / Unexpected token. Line 2, Col: 12.\n  BEGIN\n    v_xml \u001b[4m:=\u001b[0m XMLTYPE('<employee><name>John</name><salary>5000</salary></employee>')",
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 2, Col: 6.\n  /\n\u001b[4mSELECT\u001b[0m XMLQUERY(\n    'declare namespace ns=\"http://example.com\"; /ns:root/ns:item'\n    PASSING XMLTYPE('<r",
        "Parse error: Expecting ). Line 2, Col: 20.\n  SELECT XMLSERIALIZE(\n    DOCUMENT \u001b[4mXMLTYPE\u001b[0m('<root><item>value</item></root>')\n    AS CLOB INDENT SIZE = 2\n) AS formatted_xml\nFROM DUAL",
        "Parse error: Expecting ). Line 1, Col: 44.\n  SELECT XMLPARSE(CONTENT \u001b[4m'<item>value</item>'\u001b[0m WELLFORMED) AS parsed_xml FROM DUAL",
        "Parse error: Expecting ). Line 1, Col: 55.\n  SELECT XMLPARSE(DOCUMENT \u001b[4m'<?xml version=\"1.0\"?><root/>'\u001b[0m WELLFORMED) AS parsed_doc FROM DUAL",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 1, Col: 26.\n  SELECT XMLELEMENT(\u001b[4m\"person\"\u001b[0m,\n    XMLELEMENT(\"name\", JSON_VALUE('{\"name\":\"John\",\"age\":30}', '$.name')),\n    XMLELEMENT(\"age\", JS",
        "Parse error: Required keyword: 'this' missing for <class 'sqlglot.expressions.XMLElement'>. Line 2, Col: 23.\n  SELECT XMLROOT(\n    XMLELEMENT(\u001b[4m\"report\"\u001b[0m,\n        XMLATTRIBUTES(SYSDATE AS \"generated\"),\n        XMLELEMENT(\"summary\",\n            XMLFOREST",
        "Parse error: Invalid expression / Unexpected token. Line 2, Col: 15.\n  DECLARE\n    v_json \u001b[4mCLOB\u001b[0m := '{\"employees\":[{\"name\":\"John\",\"salary\":5000},{\"name\":\"Jane\",\"salary\":6000}]}';",
        "Parse error: Invalid expression / Unexpected token. Line 1, Col: 16.\n  v_name VARCHAR2\u001b[4m(\u001b[0m100)",
        "Parse error: Invalid expression / Unexpected token. Line 2, Col: 7.\n  BEGIN\n    \u001b[4mFOR\u001b[0m rec IN (\n        SELECT jt.*\n        FROM JSON_TABLE(v_json, '$.employees[*]'\n            COLUMNS (",
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 1, Col: 1.\n  \u001b[4m/\u001b[0m"
      ],
      "warnings": [
        "ROWNUM detected - semantics may differ from ROW_NUMBER()",
        "ROWNUM may not work as expected in Databricks",
        "ROWNUM detected - semantics may differ from ROW_NUMBER()",
        "ROWNUM may not work as expected in Databricks"
      ]
    },
    {
      "original_sql": "File: examples/input/10_pivot_unpivot_model.sql (SQL)",
      "success": false,
      "has_warnings": false,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Invalid expression / Unexpected token. Line 6, Col: 9.\n  SELECT *\nFROM (\n    SELECT job_id, department_id\n    FROM employees\n)\nPIVOT \u001b[4mXML\u001b[0m (\n    COUNT(*) AS cnt\n    FOR department_id IN (ANY)\n)",
        "Parse error: Invalid expression / Unexpected token. Line 6, Col: 9.\n  SELECT *\nFROM (\n    SELECT job_id, department_id, salary\n    FROM employees\n)\nPIVOT \u001b[4mXML\u001b[0m (\n    SUM(salary) AS total\n    FOR department_id IN (SELECT DISTINCT department_id FROM employees)\n",
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 3, Col: 6.\n  */\n*/\n\u001b[4mSELECT\u001b[0m product, country, year, sales, running_total\nFROM (\n    SELECT 'Widget' AS product, 'USA' AS countr",
        "Parse error: Invalid expression / Unexpected token. Line 4, Col: 5.\n  epartment_id, employee_id, salary, bonus, total_comp\nFROM employees\nWHERE department_id IN (60, 90)\n\u001b[4mMODEL\u001b[0m\n    PARTITION BY (department_id)\n    DIMENSION BY (employee_id)\n    MEASURES (salary, 0 AS bonus, 0",
        "Parse error: Invalid expression / Unexpected token. Line 4, Col: 13.\n  SELECT year_num, principal, interest, balance\nFROM DUAL\nMODEL\n    \u001b[4mDIMENSION\u001b[0m BY (0 AS year_num)\n    MEASURES (10000 AS principal, 0 AS interest, 10000 AS balance)\n    RULES ITE",
        "Parse error: Invalid expression / Unexpected token. Line 4, Col: 13.\n  SELECT n, fib\nFROM DUAL\nMODEL\n    \u001b[4mDIMENSION\u001b[0m BY (1 AS n)\n    MEASURES (1 AS fib)\n    RULES ITERATE (20) (\n        fib[ITERATION_NUMBER + 1] = CA",
        "Parse error: Invalid expression / Unexpected token. Line 4, Col: 13.\n  SELECT employee_id, first_name, department_id, salary, dept_avg\nFROM employees\nMODEL\n    \u001b[4mREFERENCE\u001b[0m dept_avg_model ON (\n        SELECT department_id, AVG(salary) AS avg_sal\n        FROM employees\n   ",
        "Parse error: Invalid expression / Unexpected token. Line 4, Col: 5.\n  CT employee_id, first_name, salary, salary_rank, new_salary\nFROM employees\nWHERE department_id = 60\n\u001b[4mMODEL\u001b[0m\n    DIMENSION BY (ROW_NUMBER() OVER (ORDER BY salary DESC) AS salary_rank)\n    MEASURES (employee_i",
        "Parse error: Invalid expression / Unexpected token. Line 4, Col: 13.\n  SELECT month_num, month_name, projected_value\nFROM DUAL\nMODEL\n    \u001b[4mDIMENSION\u001b[0m BY (1 AS month_num)\n    MEASURES (\n        CAST(NULL AS VARCHAR2(20)) AS month_name,\n        1000 A",
        "Parse error: Invalid expression / Unexpected token. Line 4, Col: 13.\n  SELECT id, val1, val2\nFROM (SELECT 1 AS id, 100 AS val1, 0 AS val2 FROM DUAL)\nMODEL\n    \u001b[4mDIMENSION\u001b[0m BY (id)\n    MEASURES (val1, val2)\n    RULES SEQUENTIAL ORDER (\n        val2[1] = val1[1] * 2,\n     ",
        "Parse error: Invalid expression / Unexpected token. Line 4, Col: 13.\n  SELECT id, val1, val2\nFROM (SELECT 1 AS id, 100 AS val1, 0 AS val2 FROM DUAL)\nMODEL\n    \u001b[4mDIMENSION\u001b[0m BY (id)\n    MEASURES (val1, val2)\n    RULES AUTOMATIC ORDER (\n        val2[1] = val1[1] * 2,\n      ",
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 2, Col: 4.\n  */\n\u001b[4mWITH\u001b[0m sales_data AS (\n    SELECT 'ProductA' AS product, 2021 AS year, 1000 AS sales FROM DUAL\n    UNION A",
        "Parse error: Invalid expression / Unexpected token. Line 9, Col: 13.\n  OM DUAL\n)\nSELECT dept, budget, hardware, software, services, total_check\nFROM budget_data\nMODEL\n    \u001b[4mDIMENSION\u001b[0m BY (dept)\n    MEASURES (\n        budget,\n        hw_pct, sw_pct, svc_pct,\n        0 AS hardware,\n  "
      ],
      "warnings": []
    },
    {
      "original_sql": "File: examples/input/20_plsql_dynamic_sql.sql (MIXED)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 1, Col: 1.\n  \u001b[4m/\u001b[0m"
      ],
      "warnings": [
        "FETCH INTO detected - consider set-based alternatives",
        "EXIT WHEN clause - control flow may need adjustment",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Control flow EXIT_WHEN converted: Convert EXIT WHEN to IF/LEAVE",
        "Collection.COUNT converted: Use SIZE() for collection count",
        "BULK COLLECT converted - result is now array type",
        "FETCH INTO cursor operations may need review for Databricks compatibility",
        "ROLLBACK: Limited transaction support in Databricks SQL.",
        "TABLE OF types converted to comments - use ARRAY<type>",
        "Cursor attributes (%NOTFOUND, %FOUND, %ROWCOUNT) need manual review",
        "Cursor attribute %NOTFOUND: Track cursor notfound status in variable",
        "Cursor attribute %ROWCOUNT: Track cursor rowcount in variable",
        "%ROWTYPE references need struct definition from table schema",
        "EXECUTE IMMEDIATE: Verify dynamic SQL compatibility",
        "REF CURSOR: Review cursor handling in Databricks",
        "Sequences need conversion to Identity columns or UUID()",
        "RECORD types need conversion to STRUCT<>",
        "OUT parameters detected: ['p_result']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Convert OUT parameters to alternative approach",
        "OUT parameters detected: ['p_result']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "Convert OUT parameters to alternative approach",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "EXECUTE IMMEDIATE: Verify dynamic SQL compatibility",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "EXECUTE IMMEDIATE: Verify dynamic SQL compatibility"
      ]
    },
    {
      "original_sql": "File: examples/input/11_dml_operations.sql (SQL)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Invalid expression / Unexpected token. Line 3, Col: 3.\n  */\nUPDATE employees\n\u001b[4mSET\u001b[0m salary = 7000\nWHERE employee_id = 100",
        "Parse error: Invalid expression / Unexpected token. Line 7, Col: 10.\n     JOIN departments d ON e.department_id = d.department_id\n    WHERE d.department_name = 'IT'\n)\nSET \u001b[4msalary\u001b[0m = salary * 1.10",
        "Parse error: Invalid expression / Unexpected token. Line 2, Col: 11.\n  */\nDELETE \u001b[4mFROM\u001b[0m employees WHERE employee_id = 300",
        "Parse error: Invalid expression / Unexpected token. Line 8, Col: 10.\n  WHEN MATCHED THEN\n    UPDATE SET \n        t.salary = s.salary,\n        t.last_updated = SYSDATE\n    \u001b[4mDELETE\u001b[0m WHERE t.status = 'INACTIVE'\nWHEN NOT MATCHED THEN\n    INSERT (employee_id, first_name, last_name, s",
        "Parse error: Invalid expression / Unexpected token. Line 4, Col: 10.\n  ECT employee_id, first_name, last_name, email, hire_date, job_id, salary\nFROM staging_employees\nLOG \u001b[4mERRORS\u001b[0m INTO err$_employees ('Load ' || TO_CHAR(SYSDATE, 'YYYY-MM-DD'))\nREJECT LIMIT UNLIMITED",
        "Parse error: Invalid expression / Unexpected token. Line 3, Col: 3.\n  UPDATE employees\nSET salary = TO_NUMBER(salary_string)\n\u001b[4mLOG\u001b[0m ERRORS INTO err$_employees REJECT LIMIT 100",
        "Parse error: Invalid expression / Unexpected token. Line 9, Col: 3.\n  ry)\n    VALUES (s.employee_id, s.first_name, s.last_name, s.email, s.hire_date, s.job_id, s.salary)\n\u001b[4mLOG\u001b[0m ERRORS INTO err$_employees ('MERGE_' || TO_CHAR(SYSDATE, 'YYYYMMDD'))\nREJECT LIMIT 1000"
      ],
      "warnings": [
        "Date arithmetic detected - verify date operations",
        "Oracle sequences detected. Consider using Databricks IDENTITY columns or custom sequence implementation.",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations"
      ]
    },
    {
      "original_sql": "File: examples/input/18_plsql_packages.sql (MIXED)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 2, Col: 1.\n  /\n\u001b[4m/\u001b[0m\n/\n/\n/\n/\n/\n/\n/"
      ],
      "warnings": [
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "Collection.EXISTS converted: Check index bounds",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "OUT parameters detected: ['p_result']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "OUT parameters detected: ['p_result']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "OUT parameters detected: ['p_result']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Convert OUT parameters to alternative approach",
        "Convert OUT parameters to alternative approach",
        "Convert OUT parameters to alternative approach",
        "Sequences need conversion to Identity columns or UUID()",
        "Sequences need conversion to Identity columns or UUID()",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Sequences need conversion to Identity columns or UUID()",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "Collection.DELETE converted: Clear collection by assigning empty array",
        "Collection.EXISTS converted: Check index bounds",
        "Collection.EXISTS converted: Check index bounds",
        "Collection.DELETE_ELEM: Element deletion needs FILTER or array reconstruction",
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "Control flow RAISE_NAMED converted: Use SIGNAL to raise named exception",
        "Collection.COUNT converted: Use SIZE() for collection count",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Collection.COUNT converted: Use SIZE() for collection count",
        "Control flow RAISE_NAMED converted: Use SIGNAL to raise named exception",
        "OUT parameters detected: ['p_cursor']. Databricks SQL doesn't support OUT parameters directly. Consider returning a STRUCT or using temporary tables.",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Collection.COUNT converted: Use SIZE() for collection count",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Convert OUT parameters to alternative approach",
        "Sequences need conversion to Identity columns or UUID()"
      ]
    },
    {
      "original_sql": "File: examples/input/03_aggregate_functions.sql (SQL)",
      "success": false,
      "has_warnings": false,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Expecting ). Line 1, Col: 30.\n  SELECT COUNT(ALL \u001b[4mdepartment_id\u001b[0m) AS all_depts FROM employees;",
        "Parse error: Expecting ). Line 2, Col: 34.\n  SELECT department_id,\n       LISTAGG(first_name, ', ' \u001b[4mON\u001b[0m OVERFLOW TRUNCATE '...' WITH COUNT) \n           WITHIN GROUP (ORDER BY first_name) AS employees\nFRO",
        "Parse error: Expecting ). Line 3, Col: 17.\n  SELECT department_id,\n       LISTAGG(first_name || ' ' || last_name, '; ' \n               \u001b[4mON\u001b[0m OVERFLOW TRUNCATE '... and more' WITHOUT COUNT) \n           WITHIN GROUP (ORDER BY last_name) AS em"
      ],
      "warnings": []
    },
    {
      "original_sql": "File: examples/input/09_hierarchical_queries.sql (SQL)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 2, Col: 4.\n  */\n\u001b[4mWITH\u001b[0m path_finder AS (\n    SELECT employee_id, manager_id,\n           SYS_CONNECT_BY_PATH(TO_CHAR(employe"
      ],
      "warnings": [
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "Date arithmetic detected - verify date operations",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "Date arithmetic detected - verify date operations",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "Date arithmetic detected - verify date operations",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "Date arithmetic detected - verify date operations",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion",
        "CONNECT BY was not converted - hierarchical query needs manual conversion"
      ]
    },
    {
      "original_sql": "File: examples/input/05_string_functions.sql (SQL)",
      "success": false,
      "has_warnings": false,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Translation error: Error tokenizing 'SELECT q'[It's a nice day]' AS quoted FROM DUA'",
        "Translation error: Error tokenizing 'SELECT q'{It's a \"nice\" day}' AS quoted FROM DUA'",
        "Translation error: Error tokenizing 'SELECT q'<It's a 'nice' day>' AS quoted FROM DUA'"
      ],
      "warnings": []
    },
    {
      "original_sql": "File: examples/input/14_plsql_basics.sql (MIXED)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 1, Col: 1.\n  \u001b[4m/\u001b[0m"
      ],
      "warnings": [
        "Explicit cursors may need manual conversion to Databricks SQL",
        "EXIT WHEN clause - control flow may need adjustment",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "SQLERRM converted to ERROR_MESSAGE()",
        "Control flow EXIT converted: Use LEAVE to exit loop",
        "Control flow EXIT_WHEN converted: Convert EXIT WHEN to IF/LEAVE",
        "Control flow EXIT_LABEL converted: Use LEAVE with label",
        "Control flow CONTINUE converted: Use ITERATE to continue loop",
        "Control flow CONTINUE_WHEN converted: Convert CONTINUE WHEN to IF/ITERATE",
        "Control flow LABEL converted: Convert label syntax",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "ROLLBACK: Limited transaction support in Databricks SQL.",
        "Explicit cursor detected - review cursor handling",
        "Cursor attributes (%NOTFOUND, %FOUND, %ROWCOUNT) need manual review",
        "GOTO: GOTO not supported in Databricks - restructure code",
        "Cursor attribute %FOUND: Track cursor found status in variable",
        "Cursor attribute %NOTFOUND: Track cursor notfound status in variable",
        "Cursor attribute %ROWCOUNT: Track cursor rowcount in variable",
        "Cursor attribute %ISOPEN: Track cursor open status in variable",
        "%TYPE references need actual type lookup",
        "%ROWTYPE references need struct definition from table schema",
        "SAVEPOINT not supported in Databricks - restructure transaction logic",
        "Sequences need conversion to Identity columns or UUID()",
        "RECORD types need conversion to STRUCT<>"
      ]
    },
    {
      "original_sql": "File: examples/input/24_lob_operations.sql (MIXED)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Required keyword: 'expression' missing for <class 'sqlglot.expressions.Div'>. Line 1, Col: 1.\n  \u001b[4m/\u001b[0m"
      ],
      "warnings": [
        "DBMS_LOB.GETLENGTH converted: Use LENGTH() for string/binary length",
        "DBMS_LOB.SUBSTR converted: Note: Parameter order differs (lob, amount, offset) -> (str, start, length)",
        "DBMS_LOB.INSTR converted: Use INSTR() for substring search",
        "DBMS_LOB.WRITEAPPEND converted: Use CONCAT() for appending",
        "DBMS_LOB.COMPARE converted: Use comparison operators",
        "DBMS_LOB.TRIM converted: Use SUBSTRING to trim LOB",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "UTL_RAW.CAST_TO_VARCHAR2 converted: Use CAST to STRING",
        "UTL_RAW.CAST_TO_RAW converted: Use CAST to BINARY",
        "UTL_RAW.LENGTH converted: Use LENGTH() function",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "DBMS_LOB.CREATETEMPORARY: Not needed - use regular string variables",
        "DBMS_LOB.FREETEMPORARY: Memory is automatically managed",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "DBMS_LOB.INSTR converted: Use INSTR() for substring search",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "DBMS_LOB.SUBSTR converted: Note: Parameter order differs (lob, amount, offset) -> (str, start, length)",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "DBMS_LOB.GETLENGTH converted: Use LENGTH() for string/binary length",
        "DBMS_LOB.TRIM converted: Use SUBSTRING to trim LOB",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "DBMS_LOB.GETLENGTH converted: Use LENGTH() for string/binary length",
        "DBMS_LOB.TRIM converted: Use SUBSTRING to trim LOB",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "DBMS_LOB.GETLENGTH converted: Use LENGTH() for string/binary length",
        "UTL_FILE.IS_OPEN converted: File operations are atomic in cloud storage",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "UTL_FILE.FOPEN: Use cloud storage APIs or Databricks file utilities",
        "UTL_FILE.FCLOSE: File handles managed automatically",
        "UTL_FILE.PUT: Accumulate data for batch write to storage",
        "DBMS_LOB.COMPARE converted: Use comparison operators"
      ]
    },
    {
      "original_sql": "File: examples/input/12_ddl_operations.sql (SQL)",
      "success": false,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [
        "Parse error: Expecting ). Line 23, Col: 29.\n   DAY TO SECOND,\n    col_blob         BLOB,\n    col_raw          RAW(100),\n    col_long_raw     LONG \u001b[4mRAW\u001b[0m,\n    col_rowid        ROWID,\n    col_urowid       UROWID,\n    col_xmltype      XMLTYPE,\n    col_bfi",
        "Parse error: Expecting (. Line 2, Col: 17.\n  CREATE MATERIALIZED VIEW LOG ON employees\nWITH PRIMARY KEY\u001b[4m,\u001b[0m ROWID, SEQUENCE (department_id, salary)\nINCLUDING NEW VALUES",
        "Parse error: Expecting ). Line 7, Col: 34.\n     sale_date DATE,\n    amount NUMBER\n)\nPARTITION BY RANGE (sale_date) (\n    PARTITION sales_q1_2024 \u001b[4mVALUES\u001b[0m LESS THAN (DATE '2024-04-01'),\n    PARTITION sales_q2_2024 VALUES LESS THAN (DATE '2024-07-01'),\n  ",
        "Parse error: Expecting ). Line 7, Col: 27.\n  BER,\n    region VARCHAR2(20),\n    salary NUMBER\n)\nPARTITION BY LIST (region) (\n    PARTITION p_east \u001b[4mVALUES\u001b[0m ('New York', 'Boston', 'Miami'),\n    PARTITION p_west VALUES ('Los Angeles', 'San Francisco', 'Seat",
        "Parse error: Expecting (. Line 1, Col: 52.\n  ALTER TABLE sales_range DROP PARTITION \u001b[4msales_q1_2024\u001b[0m"
      ],
      "warnings": [
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations"
      ]
    }
  ],
  "partial_items": [
    {
      "original_sql": "File: examples/input/08_conversion_conditional_functions.sql (SQL)",
      "success": true,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [],
      "warnings": [
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "ROWNUM detected - semantics may differ from ROW_NUMBER()",
        "ROWNUM may not work as expected in Databricks"
      ]
    },
    {
      "original_sql": "File: examples/input/16_plsql_functions.sql (PL/SQL)",
      "success": true,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [],
      "warnings": [
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "PIPE_ROW: Pipelined functions need manual conversion",
        "PIPE_ROW: Pipelined functions need manual conversion",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception ZERO_DIVIDE converted to SQLSTATE '22012'",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "Exception TOO_MANY_ROWS converted to SQLSTATE '21000'",
        "SQLERRM converted to ERROR_MESSAGE()",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax"
      ]
    },
    {
      "original_sql": "File: examples/input/02_joins_and_subqueries.sql (SQL)",
      "success": true,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [],
      "warnings": [
        "ROWNUM detected - semantics may differ from ROW_NUMBER()",
        "ROWNUM may not work as expected in Databricks",
        "ROWNUM detected - semantics may differ from ROW_NUMBER()",
        "ROWNUM may not work as expected in Databricks"
      ]
    },
    {
      "original_sql": "File: examples/input/19_plsql_collections.sql (MIXED)",
      "success": true,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [],
      "warnings": [
        "Explicit cursors may need manual conversion to Databricks SQL",
        "EXIT WHEN clause - control flow may need adjustment",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Control flow EXIT_WHEN converted: Convert EXIT WHEN to IF/LEAVE",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "Collection.COUNT converted: Use SIZE() for collection count",
        "Collection.FIRST converted: First index is 1 for arrays",
        "Collection.LAST converted: Last index equals size",
        "Collection.EXISTS converted: Check index bounds",
        "Collection.PRIOR converted: Previous index",
        "Collection.NEXT converted: Next index",
        "Collection.DELETE converted: Clear collection by assigning empty array",
        "Collection.EXTEND converted: Arrays grow automatically in Databricks",
        "Collection.TRIM converted: Use SLICE to trim elements from end",
        "Collection.LIMIT converted: No practical limit for arrays",
        "BULK COLLECT converted - result is now array type",
        "FETCH INTO cursor operations may need review for Databricks compatibility",
        "ROLLBACK: Limited transaction support in Databricks SQL.",
        "TABLE OF types converted to comments - use ARRAY<type>",
        "VARRAY types converted - use ARRAY<type>",
        "Explicit cursor detected - review cursor handling",
        "Cursor attributes (%NOTFOUND, %FOUND, %ROWCOUNT) need manual review",
        "Cursor attribute %ROWCOUNT: Track cursor rowcount in variable",
        "%TYPE references need actual type lookup",
        "%ROWTYPE references need struct definition from table schema",
        "Collection.DELETE_ELEM: Element deletion needs FILTER or array reconstruction",
        "FORALL needs review - batch DML converted to loop",
        "RECORD types need conversion to STRUCT<>"
      ]
    },
    {
      "original_sql": "File: examples/input/07_numeric_functions.sql (SQL)",
      "success": true,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [],
      "warnings": [
        "Date arithmetic detected - verify date operations",
        "CONNECT BY was not converted - hierarchical query needs manual conversion"
      ]
    },
    {
      "original_sql": "File: examples/input/06_date_functions.sql (SQL)",
      "success": true,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [],
      "warnings": [
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "Date arithmetic detected - verify date operations",
        "CONNECT BY was not converted - hierarchical query needs manual conversion"
      ]
    },
    {
      "original_sql": "File: examples/input/25_complete_etl_package.sql (MIXED)",
      "success": true,
      "has_warnings": true,
      "functions_detected": [],
      "unsupported_constructs": [],
      "errors": [],
      "warnings": [
        "Databricks doesn't support packages directly. The package will be converted to individual procedures/functions.",
        "Restructure package into individual stored procedures/functions",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "Collection.COUNT converted: Use SIZE() for collection count",
        "BULK COLLECT converted - result is now array type",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "Exception NO_DATA_FOUND converted to SQLSTATE '02000'",
        "Control flow NULL_STMT converted: NULL statement as no-op",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "SELECT INTO converted to SET variable = (SELECT ...) syntax",
        "EXECUTE IMMEDIATE: Verify dynamic SQL compatibility",
        "AUTONOMOUS_TRANSACTION not supported - use separate procedure call",
        "EXECUTE IMMEDIATE: Verify dynamic SQL compatibility",
        "Cursor attribute %ROWCOUNT: Track cursor rowcount in variable",
        "EXECUTE IMMEDIATE: Verify dynamic SQL compatibility",
        "EXECUTE IMMEDIATE: Verify dynamic SQL compatibility",
        "DBMS_UTILITY.FORMAT_ERROR_BACKTRACE converted: Stack trace not available",
        "DBMS_OUTPUT.PUT_LINE converted: Use SELECT for debugging output in Databricks",
        "Exception handling converted to Databricks SQL EXCEPTION block",
        "RAISE_APPLICATION_ERROR converted to SIGNAL SQLSTATE",
        "SQLERRM converted to ERROR_MESSAGE()",
        "SQLCODE converted to ERROR_CODE()",
        "Collection.COUNT converted: Use SIZE() for collection count",
        "COMMIT: Databricks uses auto-commit. Explicit COMMIT may be no-op.",
        "Cursor attribute %ROWCOUNT: Track cursor rowcount in variable",
        "Sequences need conversion to Identity columns or UUID()"
      ]
    }
  ]
}